# 基于多源异构LVC资源的协同控制技术 {#基于多源异构lvc资源的协同控制技术 ._标题1}

## 必要性 {#必要性 .2级列表}

太空XX任务规划与操控系统通用平台作为太空XX建设任务操控实施应用的先期探索和原型系统，整合现有西安中心X61、XXIV等新技术试验任务的地面操控系统、半实物、数字模拟器等LVC资源，协同运行完成联合试验任务想定、场景构建、仿真模拟、演习演训等功能，为后续系统建设奠定技术基础。[天地协同操控作为通用平台功能核心，响应未来天基装备体系化试验鉴定要求，构建虚实资源统一时空基准框架，打造天基多装备、多载荷、多任务的实战化天地协同操控及精细化操控能力，形成集多种资源优势为一体的跨地域协同合力。]{.mark}

因此，基于多源异构LVC资源的多任务协同控制及进程仿真功能，需要从仿真资源规范化管理调度、时空一致性实现、资源状态实时同步等多个方面充分考虑，统一实现设计。研究基于多源异构LVC资源的协同控制技术是十分必要的，其必要性体现在如下三个方面：

**（1）虚实异构仿真资源一体化与任务场景建模要求**

太空XX仿真任务的实现离不开种类繁多、结构相异、仿真能力差异化明显的仿真资源支持，如目前平台涉及的LVC仿真资源包括各类数字模拟器、半实物模拟器、地面操控系统、真星装备等，数字模拟器通常具备高倍速仿真推进功能从而实现快速推演验证，半实物模拟器往往缺乏功能但其仿真效果上更加贴近真实。各类仿真资源由于其功能要求上的侧重不同，在组织形式、接口实现上往往差异化明显。目前，行业内各任务、各承研方实现的仿真资源缺乏统一规范化的建模标准，在功能及接口上支持本任务使用即可，初始化设置及导调控制往往通过定制化前端交互甚至是程序命令键入的方式，其流程步骤复杂、操作门槛较高，缺乏规范化接口与操作流程，大量的仿真资源在任务后因缺乏规范化管理手段而无法继续使用，造成建设资源的浪费。

对异构仿真资源的规范化注册，有助于仿真系统中的仿真资源设备（地面操控系统、半实物、数字模拟器）顺利引接入通用平台并进行常态化运行，完成全局仿真资源的统一管控与推广应用。同时，为了避免各类仿真资源信息应用时语义上的歧义，必须使用统一的资源描述语言。因此，在仿真资源一体化管理方面，亟需通用平台对资源全局一致性描述，利用系统的、集成的资源描述方法对各类仿真资源类型构建规范的、统一的描述方法，形成相关建模标准。资源的全局一致性描述使得仿真资源在建模仿真全过程能够得到一致性的理解，实现仿真资源的重用，提高建模仿真的效率。另外的，严格按照任务模型进行仿真资源调度，有利于推进仿真进程，减轻参试人员负担，提高任务效率。

**（2）基于分布式资源的时空一致性、环境一致性要求**

通用平台集成了西安中心内部多个地面操控系统、半实物、数字模拟器等分布式LVC资源，在实行遥操作、加注对接、抵近侦查等各项多星交互仿真任务时，其时空一致性、环境一致性要求高，需多个仿真资源严格按照统一时间基准、空间基准、光照环境基准、空间环境基准等进行推进。在仿真进程推进过程中，各任务飞行器数据基准时间不同、坐标系定义不同、转序不同、光照环境计算结果不同、空间环境模型不同，若缺乏统一的基准描述，无法保证联合试验事件发展的逻辑性、有序性，难以对真实任务场景各要素模拟还原。因此，对异构分布式LVC资源的联合运用，亟需形成一套标准化的一致性处理方法，对各仿真资源进行时空一致性、环境一致性处理，从而保证仿真进程的有序推进。

**（3）资源数据实时交互同步与导调控制要求**

在仿真场景初始化及进程推进过程中，由于各资源仿真能力、模拟精度的差异，常常需要相互间状态数据的实时交互，保证整体运行状态的一致性。仿真平台需要对不同资源数据合理组织、有序管理、高效流转，并提供标准化的数据资源交互接口，保证状态数据交互的时效性，从而维持仿真任务的实时运转。同时，在仿真进程推进过程中，常常出现仿真倍速调整、跳时、仿真步长调整、环境转态调整等导调控制需求，需要平台进行仿真过程暂停、仿真状态变更以达成导调控制目的，如何快速实现导调控制相关功能是本平台建设重点之一。

## 技术难点及现状分析 {#技术难点及现状分析 .2级列表}

利用虚实一体仿真技术构建的通用平台根据任务场景生成作战环境，对作战过程和战场环境进行推演和模拟，参考美军提出的LVC（实体-虚拟-构造）仿真体系结构，结合数字化模型、模拟多种装备的半实物仿真模型等，基于多源异构仿真模型协同控制构建战场仿真系统。实现真实有效的仿真任务，需要对仿真层面的虚拟资源和实物资源等进行规范化建模，构建在时空上互相耦合的联合仿真试验平台，在不同作战环境下的作战效能进行综合推演验证，将已有的、独立分散的、不同类型真实、虚拟、构造仿真系统进行互联互通，灵活实现仿真任务的导调控制，响应灵活易用的数字化仿真要求。综上，[以基于多源异构LVC资源的协同控制技术为核心构建通用化仿真平台]{.mark}，满足太空XX任务操控实施应用需求，对其技术难点及现状研究集中体现在以下几个方面：

**（1）复杂异构仿真资源一体化建模实现与管理难**

模块化、通用化、可扩展是仿真资源应具备的重要特征,合理利用仿真资源的相关特性，有助于仿真系统中的仿真资源设备（地面操控系统、半实物、数字模拟器）顺利引接入通用平台。对各资源进行统一建模与管理，实现仿真场景的组织构建与常态化运行，是平台应实现的重要功能之一。然而，各任务系统模拟器、真星装备、地面系统组织形式多样、接口实现复杂，缺乏相关标准规范，因此实现仿真资源统一注册、管理，对分散、孤立的仿真资源进行统一纳管十分困难。通用平台应集中解决LVC仿真资源一致性描述与初始化问题，规范化仿真资源调度、控制等相关操作接口，实时获取仿真资源设备状态信息，开展建模与场景构建等工作，更好地为任务实现提供支撑。

经调研了解，当前已有的仿真资源描述方法多种多样，都具有各自的特点和适用范围，许多组织都在筹划统一仿真资源描述规范，希望不仅可以满足自身资源描述的需求，而且可以与其他仿真系统进行无障碍互操作。起源于九十年代中期的Globus项目，使用了资源结构化语言（Resource
Specification Language,
RSL）来对资源进行描述，RSL引入\<attribute,value\>的属性/值对来实现资源描述的目的，但是由于RSL方法的产生基于特定的环境，适用范围窄，不适用于其他仿真项目的应用。

资源描述框架（Resource Description
Framework,RDF），这种资源描述的依据是元素描述语言，W3C提出了资源描述框架RDF来描述Web信息，将这些Web信息赋予特定的语义表述。RDF具有两种描述标准，一种是RDF模型与资源语法描述规范，采用\<资源、属性、值\>的三元组方法来描述资源；另一种标准是RDF模式规范，这种标准定义了RDF元素的机制，是RDF的扩展。由于RDF只提供了少量的基础性词汇表，因此RDF相比于RSL描述方法具有比较强的通用性，可以用它来描述任意仿真资源，但其用户使用的随意性太大。如果仅仅用于描述资源，RDF确实具有比较好的通用性，但是对于资源之间的事件与交互等仿真要素，RDF并没有定义特定的元素进行描述，对模型的交互关联表达能力有限。

仿真资源描述规范（Simulation Reference Makeup Language,
SRML）是由美国波音公司订制，并且将其作为W3C标准进行提交发布的一种仿真参考标记语言规范。SRML使得仿真资源能够在特定的标准下通过网络进行传送、接收和处理，与RDF相比SRML有一套完整的元素来描述仿真模型，这些元素作为描述标签对仿真事件、仿真实体进行表达。此外SRML还允许描述模型时插入JavaScript、

VB等脚本语言，同时它还为用户提供一个特定的运行描述文件环境。但是SRML订制的元素体系主要用于模型对的描述，对仿真系统的其他资源描述能力较差。

以上各种仿真资源描述方法都可以对仿真资源的属性进行描述，但对资源使用环境、资源描述对象都有一定的要求。元数据是由符号组成，用来描述资源和特征，在许多领域有具体的应用，在国内有许多元数据的标准，应用最广泛的是都柏林元数据标准，其在兼容国际标准的同时，内容更加详细全面。同时可扩展标记语言（XML），是由W3C提出的结构化网络规范，具有描述复杂数据的能力和开放性的特点。元数据与XML结合对资源进行描述，可以极大的增加资源操作的灵活性。

在通用平台项目中，未来的仿真资源数量会不断增多，资源种类也不断复杂化，逐步需要建设仿真资源管理工具或系统，目前在国内应用比较广泛的有神州惠普公司研发的AppSRM仿真资源一体化管理平台，以及针对仿真集成环境和资源设计的仿真综合集成环境管理系统SIERM。AppSRM管理平台通过建立集中式的数据库，将大量仿真资源进行统一管理实现资源的积累，增强仿真资源的可重用性和共享性。AppSRM主要有两大特点：1）支持分布、异构性的平台，可以通过统一的资源访问接口将各类仿真资源进行整合；2）多维度管理结构和对维度数据结构，针对每个业务特点以多种维度对已经管理的各种资源进行分类查询浏览等。在后续的平台建设和开发中可以考虑以集成三方组件或自研的方式建设仿真资源管理系统，有效利用各类仿真资源的特性和优势，促使仿真资源协同或并行的方式完成仿真任务，可以适应不断增长的仿真作战需求。

**（2）仿真资源时空一致性控制实现难**

通用平台中实装操控系统、数字模拟器、半实物模拟器等异构LVC资源运行分布在不同位置、不同服务器节点上，其时间步进策略不同、时统精度存在差异化。一方面，各节点对运行其上的实体具有自身局部的时间、空间、环境描述方法，节点之间的描述方法有所差异。另一方面，联合试验环境又要求基于局部时间和空间描述的各类实体在一个公共的仿真任务空间中彼此互操作，由通用平台进行统一控制。节点之间超出一定限度的时空不一致，将严重影响联合试验的逼真度和试验结果的可信度，基于各资源时空、环境一致性的仿真进程推进是本平台需要解决的技术难题之一。在资源各项一致性实现中，时间一致性较为复杂，通过对离散事件系统仿真时间管理机制和时间同步方法进行研究，进行各仿真资源的时间有序控制。

仿真技术按照仿真模型的类型可分为连续系统仿真，离散事件系统仿真，连续/离散事件混合
系统仿真和定性系统仿真。其中，离散事件系统是指系统的状态仅在离散的时间点上发生变化的系统，这些离散时间点具有不确定性，其仿真的系统模型是以面向事件、面向进程、面向活动的方法进行描述的。在当前仿真系统研究和时间当中，离散事件系统存在两种基本推进方式：

1）以时间为单位推进(Time-Unit
Advance)：选择适当的时间单位作为固定的时间推进步长。每推进一步都作如下处理：首先检查事件列表内有无事件在该时间推进步长内发生，若没有，则仿真时钟向前推进一个时间单位；若有，则处理事件，相应的改变系统状态，然后向前推进一个时间单位。如果该步内有多个事件发生，用户必须事先规定好处理各类事件的优先级。

2）以事件为单位推进(Event-Unit
Advance)：因为离散事件系统中在两个相邻事件之间系统状态不会发生变化，所以仿真时钟可以跨过这些"不活动"的时间段，从一个事件发生时刻直接推进到下一个事件发生的时刻。每次推进都从事件列表中选择相对当前时刻最早发生的事件，将仿真时钟推进到该事件发生的时刻，仿真时钟的推进呈现跳跃性。由于事件的产生具有随机性，仿真时钟的推进速度也随之具有随机性。

在时间步进仿真中，所有仿真资源的本地时钟在真实时间的每个时间点都保持相同的值，即每个本地时钟以一序列的离散值（0，Δ，2Δ，3Δ，......）向前推进。换句话说，仿真依据全局时间向前推进而所有的本地局部时间就相当于全局时间值的一个拷贝。只有当所有仿真资源在第
i 步都处理完在时间间隔\[iΔ,(i +1)Δ
\]内的全部事件时，才允许仿真资源向前推进，开始处理下一个时间间隔内发生的事件。这种策略通过避免死锁、避免可能出现的巨大通讯量以及存储器的需求量等问题，实现了仿真进程的正确执行，此外，它还有效利用了并行处理环境中高可靠的栅障同步机制。

在每个完整的分布式仿真系统中，均有一套独立的时间描述方法，需要形成各个节点之间时间信息和空间信息相一致的一体化环境。时空一致性保证各分系统时间的误差主要来自两个方面：一是分系统本身时间存在差异，时间精度与准确度都不相同，二是网络信号传输存在的时间消耗。解决系统间的时间差异，可通过时间同步策略实现；而网络上的时间消耗，可以通过
DR
推算来进行时间补偿。目前，在分布系统领域实现时间同步通常有以下三类方法：

1）基于软件的时间同步：该方法是完全基于软件来实现，保证各个仿真成员的时间一致。但是这种方法存在明显的劣势，即时间信号的传送，会有较大的延时，而且取决于网络的性能，除此之外，软件同步必然会大幅增加处理器计算处理的开销，如果对于实时性要求高的系统，比如信号级半实物仿真系统，单纯靠软件方法，并不能满足要求。

2）基于硬件的时间同步：主要是在仿真设备上，安装时钟板卡，接收我国自主研制的北斗系统（BD）或者全球定位系统(GPS)发射的时间信号来实现。这种方法实现的精度非常高，其劣势在于成本太高，每块板卡的价格都在数千元以上，如果试验的规模较大，每各节点都需配备板卡，试验成本将大幅增加。

3）分层混合同步：顾名思义，便是综合前两种方法，最终达到各成员间时间的差异在允许范围内。该方法则是综合了上述两种方法的优点，是一种较为经济，精度也能符合要求的方法。具体的实施方案是在参与试验的系统中关键的节点上配置硬件时钟板卡，采集精确地时钟信号，然后以该节点为中心，向周围节点发送时间信号，最终使所有节点保持时间一致。时钟信号可通过高速实时网络（比如反射内存网等）发送给每个分系统，分系统中负责给接受时间信号的节点可称为时钟服务器。

在本平台中考虑到所涉及到的半实物/数字模拟设备的特性，时间发生器则更适合采用以时间为单位推进的同步仿真算法来设计。LVC资源协同控制子系统采用以时间为单位，由子系统定时器控制仿真时间推进。为保证各异构资源与仿真时间保持同步，异构系统中只有一个时间控制节点，该节点能够获取系统中物理时间信息，并能够产生仿真时间的推进信号，该信号通过以太网UDP协议组播的方式在本子网中控制时间的推进，同时能够支持仿真速率调整及跳时等操作。同步仿真中的全局时间是步进的，并且所有的仿真资源的局部时间与全局时间始终保持一致，具有实现方式简单，可靠性好，系统资源消耗较少等优点。

分布式仿真时间一致性实现上，采用多级分层混合同步方案，按照参试资源所需要完成的任务不同，以及资源收发指令和数据处理能力的不同，将资源分配到不同的参试域中进行协调管理，在多域参试一体化协同系统中，配置统一的时钟源（如：北斗授时、GPS授时、NTP服务器），由时间管理模块来提供平台全局时间与物理时间的联系能力，仿真控制节点来完成对各子域中的异构资源的时间推进，对于交互频繁或计算要求较高的模型，需要确保不同参试资源域间的时间和数据一致性，这种多级分层混合方案可以使得LVC各试验节点可以按照正确顺序去处理消息，同时各仿真资源能够以相同的仿真时间实现步进，具有全局可控性。

**（3）仿真资源状态强实时交互实现难**

通用平台定位于建设面向跨域LVC资源的仿真平台，其各个资源部署网络环境存在差异、网络带宽有限。在复杂仿真任务场景下，从任务场景的初始化到仿真进程推进过程中，各资源产生的实时状态数据需按固定频率交互同步，下传数据需经过通用平台数据处理分系统解析处理，造成网内流通数据量瞬时峰值过高、网络时延不稳定、网络传输平均延迟明显增大等问题。使得各节点彼此收到的交互数据是明显延迟的历史数据，加之时空一致性同步控制，与标准时间推进产生巨大差异，造成各仿真资源状态实时交互实现存在障碍。

因此，构建LVC联合仿真平台，必须要解决数据通信问题，尤其要注重数据传输的实时性，降低带宽压力，提高通信效率。常见网络通信机制主要有三类：

1）点对点（Point to
Point）通信模式：点对点通信是最简单的通信方式，电话就是最典型的点对点通信设备。使用电话时，需要知道对方的号码。一旦建立连接，便可以有高带宽的交互。该通信模式最大的弊端就是不能同时建立多个连接，比如打电话时不能同时跟两个人通话，应用范围受到限制。

2）客户端-服务器（Client-Server）模式：客户端-服务器模式是一种多对一的结构。在实际的系统设计中，如果客户端想要访问服务器的数据库或者其它的集中式资源，C/S
模式将会很合适。然而，在分布式仿真系统中，大部分的节点都会有信息需要输出，该模型必然会引起大量的性能问题。。

3）发布-订阅（Publish-Subscribe）模式：在该模式下，计算机节点订阅他们所需要的数据，并发布他们可以共享的数据。信息直接在发布者和订阅者之间传递，而不是像
C/S
模式一样需要在集中服务器进行数据传输。该模式是专门为简化一对多的数据传输要求而设计的，在这种模式里，应用程序只是简单地发布或订阅数据。

由此可见，和其它的集中通信机制进行比较，发布-订阅机制最显著的优势在于发布者与订阅者之间不用紧紧相连，耦合程度低，如此分布式系统中各个仿真成员间便可实现互不干扰，保证各自独立的特点。在该模式下，各仿真实体无需知道对方的具体地址以及具体数量，这就可以大幅简化应用配置，并且可更简单地使用仿真组件。

在通用平台项目方案中，仿真资源间的消息通信模式主要采用发布-订阅模式，由LVC协同控制子系统负责发布仿真时间推进消息和导调控制消息，其他仿真资源和地面控制系统软件进行订阅，实现在整体的仿真实验任务进程推进，同时系统内仿真资源间也可以通过发布-订阅方式完成任务协作消息传递和处理。发布-订阅的消息通信模式，能够实现各资源的数据松耦合、时间松耦合、空间松耦合，仿真成员间可实现互不干扰，保证各自独立运行。对于部分无发布-订阅消息能力的数字/半实物模拟器资源则采用客户端-服务器模式，统一由LVC协同控制子系统进行协调和控制。

目前HLA是分布式仿真系统普遍采用的标准，基于HLA/RTI（Run Time
Infrastructure，RTI）成为当前分布式交互仿真的主要解决方案。然而HLA的C/S架构所带来的带宽瓶颈，导致其在大规模分布式仿真系统与高实时仿真系统的应用中面临数据的实时性问题。而DDS即数据分发服务（Data
Distribution
Service）是由OMG组织制定的一套API与互操作性协议规范，定义了一种以数据为中心的发布/订阅架构，能够满足系统实时、高效的数据交互需求。因此在针对高实时性要求的仿真环境，特别是嵌入实物/半实物的仿真系统中，采用DDS技术的分布式仿真系统的设计也是一种选择，在平台后续持续演进中可考虑采用DDS组件来完成仿真环境中各类仿真资源之间的信息交互。

## 解决途径 {#解决途径 .2级列表}

综上所述，平台总体上结合虚实仿真一体化建模方法，对本平台中参试资源进行统一管理和控制，按方法规范完成模拟器资源、实装资源、平台参试资源的统一建模，在资源管理组件中完成资源注册。由LVC协同控制模块引接任务规划子系统的想定实验方案完成任务时间、资源参数等初始化，通过发布-订阅模式的消息中间件实现仿真任务中各类资源的时间统一、指令导调、数据协同，对部分模拟器和实装资源采用客户端-服务器模式进行导调控制。时间进程控制器接收导演部的任务导调命令，提供任务进程时间推进、进程状态暂停、倍速、跳时等功能，结合时间步进推进方法与多级分层混合同步方案，实现平台资源的一致性控制。

![199](C:/Users/Jelly/Desktop/share/任务规划/media/image1.emf){width="5.615972222222222in"
height="3.2243055555555555in"}

图 **错误!文档中没有指定样式的文字。**‑42 基于多源异构LVC资源的协同控制

### 虚实仿真资源一体化建模技术

对仿真资源进行一体化建模，包括仿真资源的控制接口、数据接口、资源之间的通信协议,实现仿真资源的标准化和通用化。对仿真资源进行集成管理实质是深入挖掘资源之间的各种关联关系，使处于平台管理下的仿真资源形成一个抽象化整体。对资源进行集成管理的方式有多种好处。首先，各种类型、不同地域、异构的资源被集成管理起来，消除了信息理解上的差异，大大推动的资源共享的力度；其次，集成的资源管理将资源之间的关系作为一个重点来进行管理，这样用户对资源调度和使用将会更加方便。

#### 面向业务应用分析的资源分类方法

LVC仿真资源广泛存在于各个任务系统，因其可复用性特征，应当被充分管理和重复利用，如果在每次仿真建模时都要重新开发新的仿真资源，不仅浪费大量的人力、时间和金钱，使现有资源无法发挥其存在价值，也无法保证新开发模型的可信度及与其它系统的互联互操作性。要实现对LVC仿真资源的注册管理，首先要基于业务应用角度分析，解决资源的分类问题。

从实际需求出发，我们可以将能够被重复利用的仿真资源主要分为两大类：物理资源和信息资源。其中，信息资源包括平台中相对独立、能够为其他系统服务的资源，如仿真指令、仿真交互数据、相关仿真任务信息以及通用逻辑等；物理资源是指能够提供信息化接入方式的具体的物理实体资源，如半实物模拟器、数字模拟器、真星系统、信息化装备等。本章节主要针对物理资源进行建模方法总结，信息资源在9.3.1.3导调控制相关章节中进行阐述。

<figure>
<img src="C:/Users/Jelly/Desktop/share/任务规划/media/image2.emf"
style="width:5.6in;height:1.90417in" alt="201" />
<figcaption><blockquote>
<p>图 <strong>错误!文档中没有指定样式的文字。</strong>‑43
仿真资源交互</p>
</blockquote></figcaption>
</figure>

#### 基于四元组的LVC资源描述方法

在仿真资源建模中，本体是个很重要的概念。本体的概念最初源自于哲学领域，在哲学中的定义为"对世界上客观事物的系统描述，即存在论"。哲学中的本体关心的是客观现实的抽象本质。而在计算机领域，本体是可以在语义的层次上来对知识进行描述，可以看做是某一个领域知识的通用模型。本体的描述语言提供了概念、概念之间的关联、概念的实例等基本建模元素。仿真资源的形式化描述就是通过规范的语言和格式对资源的属性进行描述，使得资源可识别、能重用和互操作。

四元组描述方法就是基于本体描述的思想，对仿真资源的属性进行规范描述，使得描述的资源具有很好的通用性和可理解性。根据仿真建模中仿真资源的特点，四元组描述法将资源的属性分为四块：基本属性、关联属性、动态属性和自定义属性。通过对资源的每部分属性进行描述从而形成仿真资源整体的
形式化描述文档。

P(r) = \<BP(r), L(r), D(r), CP(r)\>

 P(r)为资源本体，也是资源属性的总集，包含资源所有可描述的属性。

 BP(r)表示资源的基本属性，它是所有资源都必须具备的属性。

 L(r)表示资源的关联信息，描述资源在仿真建模中与其它资源的关系。

 D(r)表示资源的动态信息，它记录资源在仿真运行时的动态变化情况。

 CP(r)表示自定义属性，允许用户根据资源的特点进行自定义。

四元组描述模型由四个资源属性子集组成，每个属性子集代表资源的一类相关属性，它们的描述内容和特点如下：

资源的基本属性是所有资源都具备的属性，它包括资源的ID、名称、类型、创建时间等。资源的基本属性不能为空，通过它可以实现资源的识别和定位。

关联信息描述的是资源在仿真建模中与其它资源的关系。仿真运行时需要
对各种资源进行关联来为执行做准备，通过这些关联能将仿真资源联系起来，驱动仿真运行。

动态信息记录资源在仿真运行时的动态变化情况。这些资源信息最大的特
点是变化很快，对于实时了解仿真进程和资源使用情况很重要。它们是用户和系统非常关心的信息，需要描述的动态信息有很多，比如仿真进程中资源的占用情况、资源消耗情况和资源的属性变化等。

自定义属性，允许用户根据资源的特点进行自定义，它提供了扩展资源描
述能力。由于资源的种类很多，资源的属性也差别很大，对资源的描述重点也不一样，因此不同资源的自定义属性也不一样。

针对XX平台的仿真资源特点，结合四元组描述方法，形成以下表格，对仿真物理资源（半实物/数字模拟器、地面操控系统）进行描述，说明中体现了资源需要包含的属性信息。

  ---------------------------------------------------------------------------------------------
  资源类型                                 描述内容      说明
  ---------------------------------------- ------------- --------------------------------------
  仿真物理资源（半实物/数字模拟器/真星）   基本属性      资源名称、资源类型

                                           关联信息      资源的层次关系、隶属关系等

                                           动态属性      资源的接口描述、资源运行参数等

                                           自定义属性    资源运行环境及其它说明等
  ---------------------------------------------------------------------------------------------

  : 表5-1仿真资源属性四元组描述

#### LVC资源描述的形式化表达

四元组资源描述的形式化表达可以采用XML作为描述语言，可以使资源的描述更加规范化。四元组描述法对资源属性进行分块描述，具有很好的统一格式。

首先，需要把资源的属性归类后进行分块，对应到四元组描述描述模型的属性子集中。然后，利用XML语言对每个属性集进行形式化描述，形成资源属性的描述片段。最后，把所有的属性子集的描述碎片进行综合集成，形成资源的XML描述文档。

<figure>
<img src="C:/Users/Jelly/Desktop/share/任务规划/media/image3.emf"
style="width:4.69583in;height:2.28819in" alt="203" />
<figcaption><blockquote>
<p>图
<strong>错误!文档中没有指定样式的文字。</strong>‑44基于属性子集的资源描述方法</p>
</blockquote></figcaption>
</figure>

**（1）基本属性BP(r)的描述片段**

\<BP AttributesSet=\"基本属性\"\>

\<Attribute Name=\"Name\" DataType=\"string\" Descript=\"资源名称\"/\>

\<Attribute Name=\"Type\" DataType=\"string\"
Descript=\"半实物/数字模拟器\"/\>

\</BP\>

**（2）关联信息L(r)的描述片段**

\<L AttributesSet=\"关联信息\"\>

\<Attribute Name=\"ParentID\" DataType=\"string\" Descript=\"xxxx\"/\>

\</L\>

**（3）动态属性D(r)的描述片段**

\<D AttributesSet=\"动态属性\"\>

\<Attribute Name=\"InterfaceType\" DataType=\"string\"
Descript="udp、pub/sub\"/\>

\<Attribute Name=\"IP\" DataType=\"string\" Descript=\"ip\"/\>

\<Attribute Name=\"TimeSyncPort\" DataType=\"string\"
Descript=\"时间同步端口\"/\>

\<Attribute Name=\"CommandPort\" DataType=\"string\" Descript=\"指令端口
\"/\>

\</D\>

**（4）自定义属性CP(r)的描述片段**

\<CP AttributesSet=\"自定义属性\"\>

\</CP\>

#### 通用化LVC物理资源仿真建模

物理资源仿真建模主要针对在仿真平台中接入的仿真资源设备，主要包括数字物模拟器、半实物模拟器、真星系统组件等。通过LVC资源协同控制子系统统一管理，在仿真任务执行前，各物理仿真资源应完成在LVC资源协同控制子系统中的注册，根据四元组建模方法，注册时应包含以下属性：

基本属性：资源名称、资源类型

动态属性：调用方式、仿真资源ip、时间同步端口、控制指令接收端口。

可以参考如下XML描述：

\<BP AttributesSet=\"基本属性\"\>

\<Attribute Name=\"Name\" DataType=\"string\" Descript=\"资源名称\"/\>

\<Attribute Name=\"Type\" DataType=\"string\"
Descript=\"半实物/数字模拟器/真星\"/\>

\</BP\>

\<D AttributesSet=\"动态属性\"\>

\<Attribute Name=\"InterfaceType\" DataType=\"string\"
Descript="udp\"/\>

\<Attribute Name=\"IP\" DataType=\"string\" Descript=\"ip\"/\>

\<Attribute Name=\"TimeSyncPort\" DataType=\"string\"
Descript=\"时间同步端口\"/\>

\<Attribute Name=\"CommandPort\" DataType=\"string\" Descript=\"指令端口
\"/\>

\</D\>

为构建可接入数字/半实物模拟器和真星系统组件的仿真系统，数字/半实物模拟器和真星系统组件在仿真平台中具备的能力：

（1）资源注册能力：通过调用LVC资源协同控制模块的资源注册接口，注册本数字模拟器、半实物模拟器、真星。

（2）仿真时间同步接收模块：通过UDP接口的方式，接收LVC资源协同控制子系统时间发生器所产生的仿真时间，根据时间步进消息，完成仿真任务。

（3）仿真任务指令接收模块：通过UDP接口的方式，接收仿真消息总线上的仿真任务指令，作为仿真资源控制和状态改变的输入，包括仿真任务进度控制指令和仿真资源控制指令。

<figure>
<img src="C:/Users/Jelly/Desktop/share/任务规划/media/image4.emf"
style="width:5in;height:2.6in" alt="205" />
<figcaption><blockquote>
<p>图
<strong>错误!文档中没有指定样式的文字。</strong>‑45仿真平台物理资源能力要素</p>
</blockquote></figcaption>
</figure>

### 异构仿真平台时间、空间、环境基准统一方法

#### 通用时间基准统一方法

时间管理机制是保证仿真资源之间协调运行的机制，也是仿真资源的时间推进机制，它决定了仿真系统是在实时、超实时还是欠实时的情况下运行。并行与分布式系统本身没有统一的基准时间，所以必须建立并行与分布式系统的时间管理能力，以实现仿真系统的时间统一。时间同步就是其主要的实现手段，它管理各类消息的发送和接收并协调不同的时间推进机制，从而保证并行和分布式仿真的逻辑正确性。时间管理同步策略的选取和算法设计的好坏将直接影响到仿真的正确性及其性能，而时间管理同步技术的关键是时间推进算法。

根据仿真系统模型的不同可以将仿真分为连续系统仿真、离散事件系统仿真、混合系统仿真以及定性系统仿真。在连续系统仿真中，状态的变化在时间上是连续的，而在离散事件仿真中，事件的发生是瞬时性的固定在某个时间点上的。结合了离散事件和连续事件仿真特点的就是混合系统仿真。用非数值方法描述系统行为或过程的定性特性并实现系统定性模型随时间变化特性的仿真系统称为定性系统仿真。

仿真时间管理作为并行与分布式仿真的核心机制，不仅是保证仿真执行过程中因果关系正确性的基础，也是保证仿真系统的可重复性的关键技术，时间管理是决定并行与分布式仿真系统正确性和效率的首要因素。对一个系统究竟采用那种类型的仿真取决于研究目标的侧重点。

**（1）关于仿真和时间同步的概念**

1）物理时间和仿真时间

-   物理时间：被仿真的物理系统所处的现实世界中的时间，也可称为自然时间或墙钟时间。它是真实世界发展变化的度量，总是自然均匀向前流逝的。

-   仿真时间：是一个仿真资源的内部时间表示，仿真时间相对于物理时间可以是较快的、较慢的或同步的；也是在仿真试验任务中的参考时间，它在仿真进行前由仿真时间管理功能建立，是所有仿真参与者公用的时间。

2）实时仿真和比例时仿真

-   实时仿真：仿真系统时间推进与真实系统时间推进严格相同的仿真。

-   比例实时仿真：仿真系统时间推进与墙钟时间推进保持特定关系的仿真。

> 实时仿真和比例实时仿真用下面函数将墙钟时间转换为仿真时间：
>
> T~s~=T~start~+Scale\*(T~w~--T~wstart~)
>
> 其中T~w~是墙钟时间值，T~start~表示仿真开始时的仿真时间，T~wstart~表示仿真开始时的墙钟时间，Scale是比例因子。如果Scale是2则仿真以两倍速的墙钟时间运行，即墙钟时间每推进1秒则仿真时间推进2秒。

3）同步仿真和异步仿真

-   同步仿真：在时间步进的仿真中，所有的本地时钟在真实时间的每个时间点都保持相同的值，即每个本地时钟以一序列的离散值（0，1Δ，2Δ，3Δ，......）向前推进。只有当所有的仿真资源在第i步都处理完在时间间隔\[iΔ,(i+1)Δ\]内的全部事件时，才允许仿真资源向前推进，开始处理下一个时间间隔内发生的事件。这种策略通过避免死锁、避免可能出现的巨大通讯量以及存储器的需求量等问题。此外，它还有效利用了并行处理环境中高可靠的栅障同步机制。

-   异步仿真：在不同仿真时刻发生的事件彼此独立，不会互相影响是异步
    仿真的前提条件，因此同时处理各自的事件可以有效的加速仿真的执行，减少仿真的运行时间，然而这其中需要解决异步仿真可能出现的因果关系错误。当且仅当并行与分布式仿真执行所生成的全部事件的顺序与串行仿真执行所生成的全部事件的顺序相一致时，异步LP仿真能够真正确保仿真的正确执行。

**（2）多域参试一体化仿真中多层分级时间同步方法**

在面对多域参试的一体化仿真试验场景中，需要所有参试资源能够处于一致的虚拟环境中，为实现正确的事件调度，必须保证所有子域内仿真资源以一致的仿真时间联合运行。在多域参试一体化仿真系统中，配置统一的时钟源（如：北斗授时、GPS授时、NTP），使仿真平台的全局时间与物理时间相联系，由仿真控制节点来完成时间推进和全局时间一致性维护，对各子域中的异构资源的时间推进进行统一管理。对于交互频繁或计算要求较高的仿真资源，确保域间数据的一致性尤为重要。对此，可以采取多层分级时间控制策略对全网仿真时间进行统一时间推进。

针对各域内仿真资源时间推进过程的一致性问题，按照试验训练任务的不同，将XX资源分组到不同试验域进行协调管理，自上而下建立起多层分级的时间推进架构，采取不同方式协同管理时间，使得LVC各试验节点可以按照正确顺序去处理消息。

通过基础层时间推进和多层分级时间推进共同实现时间管理，同一域内的应用程序级别相同、交互频繁、通讯接口和行为逻辑类似，易于仿真平台中形成聚合，如下图所示。基础层实现各个域（Domain）或子域（Area）内应用程序时间节点的独立监管和推进。当域内功能独立且过长的通信链路时，允许划分子域，子域可以迭代但一般不宜过多，以免造成冗余管理。在基础层之上，通过设置一个或多个域管理中心时间控制者（Domain
Manager Time
Controller）负责所有试验域时间的协同运行以及全网时间节点的维护。

<figure>
<img src="C:/Users/Jelly/Desktop/share/任务规划/media/image5.emf"
style="width:3.09583in;height:3.09583in" alt="207" />
<figcaption><blockquote>
<p>图
<strong>错误!文档中没有指定样式的文字。</strong>‑46多层分级时间管理策略</p>
</blockquote></figcaption>
</figure>

更高层级的时间推进者可以控制其所在试验及子域内的低层级时间推进者，即Area1、Area2中的时间推进者受到Domain1中时间推进者的控制。而中间层时间推进者具有双重推进特性。例如，但Domain1的时间推进者想要推进Area1的时间时，向Area1的时间推进者发出指令，使得Area1的时间推进者受限于Domain1的逻辑时间；同时Area1的时间推进者还要对子域内的仿真节点履行时间控制任务。

多层分级的时间推进管理架构中各层级之间既受上一层时间的控制，同时又影响下一层级时间的推进，这种方式使得各级时间推进机制既具有高度自治性又具有全局可控性。

**（3）以时间为单位的同步仿真时间推进方法**

在西安中心系统中可用的飞行器模拟器和卫星模拟器能够以整点秒为周期的方式接收系统的仿真时间和北京时间，模拟器可以将模拟时间取出，并与自身系统时间进行对比，如果超出阈值，模拟器可以对自身系统时间进行校正。

考虑到XX平台项目中所涉及到的半实物/数字模拟设备的特性，LVC资源协同控制子系统中的时间发生器则更适合采用以时间为单位推进的同步仿真算法来设计。同时支持仿真速率的调整，即在接入时装设备时，应支持调整仿真速率为1，来进行实时仿真；未接入时装设备时可支持仿真速率调整及跳时等操作。同步仿真中的全局时间是步进的，并且所有的仿真资源的局部时间与全局时间始终保持一致，具有实现方式简单，可靠性好，系统资源消耗较少等优点。

LVC资源协同控制子系统采用以时间为单位推进的同步仿真方法推进仿真时间，由子系统定时器控制仿真时间推进。实现时，为保证各异构资源与仿真时间保持同步，异构系统中只有一个时间控制节点（LVC协同控制子系统实现），该节点能够获取系统中物理时间信息，并能够据此产生本系统的仿真推进信号（秒脉冲），该信号通过以太网在本子网内广播UDP协议的时间控制信息。系统中的其它仿真资源节点受时间控制节点发出的推进信号的控制，按照时间控制节点的同步信号向前推进，并保证在同一步长周期内完成指令和数据的收发与处理。

<figure>
<img src="C:/Users/Jelly/Desktop/share/任务规划/media/image6.emf"
style="width:5.18403in;height:3.80833in" alt="209" />
<figcaption><blockquote>
<p>图
<strong>错误!文档中没有指定样式的文字。</strong>‑47多级异构系统时间同步</p>
</blockquote></figcaption>
</figure>

LVC资源协同控制子系统时间管理方法的原理描述：

1）时间同步本子网内NTP服务器的时间，以获取当前的物理时间作为仿真1时间的初始时间Tstart，通常是当前的北京时间。

2）时间发生器在获取Tstart后，依据仿真系统中设置的仿真步长Δt,以1s为周期（节拍）进行步进，假设当前步进周期为n，可计算当前的仿真时间为T
= n \* Δt +Tstart。若步长Δt为1时，当前系统为实时仿真，若Δt \>
1，则为超时仿真。注：不设计欠时仿真。

3）时间发生器将时间信号进行特定的帧格式包装，以1秒为脉冲单位，向当前以太网中进行UDP广播。

4）数字/半实物仿真资源在接收到广播消息后，解析时间控制消息帧，获取仿真时间和北京时间。

5）数字/半实物仿真资源向前步进一个步长，完成一个仿真周期。在步进前完成本周期内的消息收发和指令处理。

![211](C:/Users/Jelly/Desktop/share/任务规划/media/image7.emf){width="5.8in"
height="1.8in"}图
**错误!文档中没有指定样式的文字。**‑48仿真时间推进与控制示意

#### 通用空间基准统一方法

多星多任务一体化运行，要求LVC试验环境构设处于相同的空间基准下完成实验任务，需要完成空间基准转换（坐标转换），通常以J2000惯性坐标系为统一基准进行仿真任务运行。坐标系转换单元负责进行地固系、惯性系、发射系等各类坐标转换，为轨道计算等其他模块提供各种便捷精确的坐标转换。

（1）地固坐标系与J2000惯性坐标系转换

地固坐标系矢量![](C:/Users/Jelly/Desktop/share/任务规划/media/image8.wmf){width="0.2in"
height="0.2in"}转换到J2000坐标系中矢量![](C:/Users/Jelly/Desktop/share/任务规划/media/image9.wmf){width="9.583333333333334e-2in"
height="9.583333333333334e-2in"}，其转换矩阵关系为：

![](C:/Users/Jelly/Desktop/share/任务规划/media/image10.wmf){width="0.9041666666666667in"
height="0.2881944444444444in"}

![](C:/Users/Jelly/Desktop/share/任务规划/media/image11.wmf){width="2.0in"
height="0.2881944444444444in"}

其中EP指地极移动矩阵，ER指瞬时真赤道坐标系到地固系的转换矩阵，PR时岁差矩阵，NR是章动矩阵。

（2）地固坐标系与测站坐标系转换

地固系中飞行器位置为![](C:/Users/Jelly/Desktop/share/任务规划/media/image12.wmf){width="9.583333333333334e-2in"
height="9.583333333333334e-2in"},测站坐标为（L,B,h），测站地固系下位置为R，则飞行器在测站坐标系下坐标R'为：

![](C:/Users/Jelly/Desktop/share/任务规划/media/image13.wmf){width="2.272222222222222in"
height="0.2881944444444444in"}

（3）飞行器本体坐标系与J2000惯性坐标系转换

飞行器本体坐标系的坐标轴![](C:/Users/Jelly/Desktop/share/任务规划/media/image14.wmf){width="0.7201388888888889in"
height="0.2881944444444444in"}在J2000坐标系中的方向余弦分别为：

![](C:/Users/Jelly/Desktop/share/任务规划/media/image15.wmf){width="1.8243055555555556in"
height="1.3118055555555554in"}

其中r和rs分别是J2000中的位置矢量和速度矢量，于是变换矩阵为：

![](C:/Users/Jelly/Desktop/share/任务规划/media/image16.wmf){width="1.4083333333333334in"
height="0.8243055555555555in"}

设某点在飞行器本体坐标系中的坐标为![](C:/Users/Jelly/Desktop/share/任务规划/media/image17.wmf){width="0.8in"
height="0.2638888888888889in"}，在J2000中坐标为![](C:/Users/Jelly/Desktop/share/任务规划/media/image18.wmf){width="0.6159722222222223in"
height="0.24791666666666667in"}，飞行器在J2000坐标系中坐标为![](C:/Users/Jelly/Desktop/share/任务规划/media/image19.wmf){width="0.7840277777777778in"
height="0.2638888888888889in"}，则有：

![](C:/Users/Jelly/Desktop/share/任务规划/media/image20.wmf){width="1.4243055555555555in"
height="0.8in"}

（4）发射坐标系与发惯坐标系转换

发射台经纬度为![](C:/Users/Jelly/Desktop/share/任务规划/media/image21.wmf){width="0.3840277777777778in"
height="0.2in"}，发射台地固系矢量为![](C:/Users/Jelly/Desktop/share/任务规划/media/image22.wmf){width="0.2in"
height="0.2in"}，射向角为![](C:/Users/Jelly/Desktop/share/任务规划/media/image23.wmf){width="0.2in"
height="0.2in"}，则发射坐标系与发惯系转换为：

![](C:/Users/Jelly/Desktop/share/任务规划/media/image24.wmf){width="4.095833333333333in"
height="0.48819444444444443in"}

其中：![](C:/Users/Jelly/Desktop/share/任务规划/media/image25.wmf){width="0.6159722222222223in"
height="0.2881944444444444in"}，![](C:/Users/Jelly/Desktop/share/任务规划/media/image26.wmf){width="0.2in"
height="0.2881944444444444in"}为地球自转角速度，![](C:/Users/Jelly/Desktop/share/任务规划/media/image27.wmf){width="0.2in"
height="0.2in"}为距离发射的时间长度。

a)  发惯性系与J2000坐标系转换

发射台经纬度为![](C:/Users/Jelly/Desktop/share/任务规划/media/image28.wmf){width="0.3840277777777778in"
height="0.2in"}，发射台地固系矢量为![](C:/Users/Jelly/Desktop/share/任务规划/media/image29.wmf){width="0.2in"
height="0.2in"}，射向角为![](C:/Users/Jelly/Desktop/share/任务规划/media/image30.wmf){width="0.2in"
height="0.2in"}，则发惯坐标系与J2000坐标系转换为：

![](C:/Users/Jelly/Desktop/share/任务规划/media/image31.wmf){width="3.8in"
height="0.2881944444444444in"}

其中：![](C:/Users/Jelly/Desktop/share/任务规划/media/image32.wmf){width="0.2in"
height="0.2881944444444444in"}为格林尼治恒星时角，![](C:/Users/Jelly/Desktop/share/任务规划/media/image33.wmf){width="0.2in"
height="0.2in"}为发射台在J2000轨道坐标系中的直角坐标，![](C:/Users/Jelly/Desktop/share/任务规划/media/image34.wmf){width="1.0in"
height="0.2881944444444444in"}

#### 通用空间光照环境统一方法

**（1）太阳位置仿真建模**

太阳位置仿真建模主要用于根据JPL星历或简化太阳位置计算公式，计算给定时刻的太阳在J2000坐标系中的位置分量，根据这一坐标分量，就可以进一步计算各种太阳光照矢量和交角。

据太阳在J2000.0坐标系中的平均轨道根数计算当前太阳轨道根数，再根据轨道根数与位置速度转换公式计算太阳J2000坐标系下位置和速度。太阳在J2000.0坐标系中的平均轨道根数![](C:/Users/Jelly/Desktop/share/任务规划/media/image35.wmf)为：

![](C:/Users/Jelly/Desktop/share/任务规划/media/image36.wmf)

其中：T为距J2000的儒略世纪数。当需要更高精度太阳位置信息时，可以从JPL星历中参数计算获得，JPL星历中包含了太阳、月球及各大行星的高精度星历数据。

**（2）月亮位置仿真建模**

月亮位置仿真建模主要用于根据JPL星历或简化月亮位置计算公式，计算给定时刻的月亮在J2000坐标系中的位置分量，根据这一坐标分量，就可以进一步计算各种月亮反射光照矢量和交角。

根据月球在J2000.0地心平黄道坐标系中的平均轨道根数计算当前月球轨道根数，再根据轨道根数与位置速度转换公式计算月球黄道坐标系下位置和速度，最后考虑黄赤交角将月球黄道坐标系参数转换到惯性坐标系下位置和速度。![](C:/Users/Jelly/Desktop/share/任务规划/media/image37.wmf)为：

![](C:/Users/Jelly/Desktop/share/任务规划/media/image38.wmf)

其中：T为距J2000的儒略世纪数。当需要更高精度太阳位置信息时，可以从JPL星历中参数计算获得，JPL星历中包含了太阳、月球及各大行星的高精度星历数据。

**（3）目标太阳光照角计算**

目标太阳光照角计算主要用于计算目标星-飞行器连线和目标星-太阳连线之间的交角值。

**（4）月亮反照光夹角计算**

月亮反照光照角计算主要用于计算月亮-飞行器连线和飞行器光学传感器视线主轴方向之间的交角值。

**（5）地球大气反照光夹角计算**

地球大气反照光照角计算主要用于计算地球大气边缘-飞行器连线和飞行器光学传感器视线主轴方向之间的交角值。

**（6）飞行器太阳光照角计算**

飞行器太阳光照角计算主要用于太阳光矢量在飞行器轨道坐标系下的坐标分量，或太阳光矢量与飞行器太阳电池板法线之间的夹角。

![353](C:/Users/Jelly/Desktop/share/任务规划/media/image39.emf){width="3.3916666666666666in"
height="3.0in"}

图 **错误!文档中没有指定样式的文字。**‑49空间位置信息图

#### 通用空间环境统一方法

**（1）空间碎片环境模型**

空间碎片环境模型对飞行在轨运行期间可能遭遇空间碎片的碰撞风险进行预测，根据飞行器的轨道信息，计算编目碎片对飞行器的碰撞风险，包括接近时间、接近距离、接近速度、交会角等信息。空间碎片环境模型模块由轨道筛选、轨道预测、交会计算、碰撞概率计算等功能组成。

1）轨道筛选：根据飞行器和碎片的轨道数据进行筛选，排除绝不可能发生碰撞的物体。筛选准则包括近地点-远地点筛选、径向筛选和时间筛选等。通过轨道筛选舍去一些轨道参数演变不可能与空间站发生碰撞的碎片。

2）轨道预测：在受力分析基础上，对飞行器和碎片的轨道进行轨道演化。采用美国发布的TLE轨道数据作为初轨进行轨道预测。TLE轨道根数是平均根数，用特定的方法去掉了周期扰动项。为保证预报精度，采用1980年12月北美防空司令部（NORAD）发布的SGP、SGP4/SDP4、SGP8/SDP8预报模型进行基于两行根数TLE的轨道预测。

3）交会计算：基于轨道预测结果，利用二分法确定交会信息。将飞行器和碎片轨道以一定步长进行轨道预报，分别得到一系列飞行器和碎片的位置、速度矢量，比较飞行器和碎片的相对位置关系，计算交会信息。初始步长设定较大，进入阈值后缩小步长，确定每个时间点的交会信息。

4）概率计算：基于预测位置、交会及误差信息，计算碰撞概率。飞行器和碎片的位置误差满足正态分布，其概率密度函数表示为：

![](C:/Users/Jelly/Desktop/share/任务规划/media/image40.wmf)

式中x~0~，y~0~表明了飞行器与碎片的相对位置关系：![](C:/Users/Jelly/Desktop/share/任务规划/media/image41.wmf)![](C:/Users/Jelly/Desktop/share/任务规划/media/image42.wmf)

R~rel~是相对位置矢量在交会平面上投影的大小，![](C:/Users/Jelly/Desktop/share/任务规划/media/image43.wmf)是相对矢量在交会平面上的投影与y轴的夹角。在简化后的二维问题中，飞行器被等效成一个坐标原心、半径为R的圆。碰撞概率就是这个范围内对概率密度函数的积分。

![](C:/Users/Jelly/Desktop/share/任务规划/media/image44.wmf)

**（2）高能粒子环境模型**

地球辐射带模型计算：计算磁层内辐射带高能质子和高能电子的通量，辐射带粒子通量是空间位置和能量的函数，指定位置和能量就可以计算出质子或电子的积分通量（能量大于指定能量的粒子通量）；采用的是AP8/AE8模式，该模式是根据卫星探测数据编制的辐射带质子、电子通量模式，根据高年和低年的不同又分为太阳活动低年的MIN模式和太阳活动高年的MAX模式。要计算空间某个位置的电子通量，先要调用地磁模型将地理位置坐标经、纬、高度转化为L、B/B0坐标，然后再采用二维插值算法在AE8数据网格进行插值计算，得到电子通量。

银河宇宙线模型计算：计算磁层内银河宇宙线质子和重离子的通量，银河宇宙线粒子通量是粒子种类、空间位置和能量的函数，指定粒子电荷数、位置和能量就可以计算出质子或重离子的积分通量（能量大于指定能量的粒子通量）；银河宇宙线各种成分的通量和能谱的计算是通过给出三种基本元素（H，He和Fe）通量的能量分布模型为基础。它们的解析表达式为：![](C:/Users/Jelly/Desktop/share/任务规划/media/image45.wmf)，单位是：粒子/(m^2^·sr·sec·MeV/n)，其他元素的能谱可根据这三种基本元素的能谱变形得到。

太阳宇宙线模型计算：计算磁层内太阳宇宙线质子和重离子的通量，太阳宇宙线粒子通量是质子事件类别、粒子种类、空间位置和能量的函数，指定质子事件级别、粒子电荷数、位置和能量就可以计算出质子或重离子的积分通量（能量大于指定能量的粒子通量）。太阳宇宙线是伴随某些太阳耀斑发生的高能带电粒子增强现象，其成分以质子为主。对于普通的质子事件，总通量平均微分能谱形式为：

![](C:/Users/Jelly/Desktop/share/任务规划/media/image46.wmf)，

式中*E*为质子能量，单位：MeV。

为了更好地估算质子事件的影响，还应根据统计结果给出质子能谱变化的上限，即为最坏能谱，根据已有的质子事件分析，超过这一能谱的概率小于10％(置信度90％)。

![](C:/Users/Jelly/Desktop/share/任务规划/media/image47.wmf)

采用相同的统计方法可以给出质子事件峰值(通量最大)期间的平均和最坏情况下的能谱：

![](C:/Users/Jelly/Desktop/share/任务规划/media/image48.wmf)

![](C:/Users/Jelly/Desktop/share/任务规划/media/image49.wmf)

磁场L-B坐标计算：L-B坐标由Mcllwain
(1961)提出，B为空间某特定点磁场强度，L为磁壳参数，对某特定磁壳，L是常数。在中心偶极子地磁场近似下，L为磁壳在赤道面上离地心距离，通常以地球半径Re为量度单位。L和B关系如下：

![](C:/Users/Jelly/Desktop/share/任务规划/media/image50.wmf){width="1.45in"
height="0.5333333333333333in"}

其中，B~m~为粒子反射镜点的磁场强度，M为地磁场的磁偶极矩，I为第二积分不变量。B、B~m~和I由使用的地磁场模式计算得到。

偶发事件模型：基于太阳宇宙线（太阳质子事件）模型，通过模型参数M（宇宙线计算空间环境状况）能够指定质子事件的类别（普通事件、1972年极端事件等），模型能够给出发生质子事件时磁层内高能粒子的分布。

**（3）电磁辐射模型**

背景太阳电磁辐射流量计算：以世界时、卫星位置、波段为输入参数，给出太阳活动平静情况下卫星位置受到的太阳电磁辐射流量；平均日地距离（1AU）处单位面积、单位时间受到的太阳电磁辐射即辐照度平均值称为太阳常数。一年中地球与太阳之间距离不断变化，受此影响通量有约3.4%的变化。太阳光谱可以用特征温度为5777°K的黑体辐射光谱近似。其中紫外波段（波长λ
\< 300 nm）光谱对航天器材料性质影响较大，平均情况下近紫外波段（180 nm
\<λ\<400 nm）电磁辐射积分通量约为118W/m^2^，远紫外波段（λ\< 180
nm）约为0.023W/m²。采用太阳黑体辐射近似模型，以世界时、卫星位置参数为输入，计算地球对太阳电磁辐射的遮挡作用，最终得出卫星位置处太阳电磁辐射频谱，并给出关心波段上的电磁辐射流量。

太阳耀斑电磁辐射流量计算：以世界时、卫星位置、波段、X射线耀斑等级为输入参数，给出太阳耀斑爆发情况下，卫星位置受到的该波段太阳电磁辐射流量。太阳爆发活动对电磁辐射流量影响较大，各个波段电磁辐射通量会有不同量级的变化。近紫外波段在恶劣情况下太阳辐照度是平均情况下1.5倍左右，紫外波段至X射线波段在恶劣情况下太阳辐照度是平均情况下的2倍左右。以太阳耀斑等级为输入参数，计算得出太阳耀斑爆发时电磁辐射典型频谱，或直接给出最恶劣情况下太阳电磁辐射频谱；以世界时、卫星位置参数为输入，计算地球对太阳电磁辐射遮挡作用；最终给出太阳耀斑爆发时卫星位置处太阳电磁辐射频谱，并给出关心波段上的电磁辐射流量。

### 实时仿真交互管理与导调控制技术

数据是仿真资源各部分联通与交互的基础和条件。数据交互管理，就是仿真平台在运行时，对数据的适时获取、调用、传送的方法，目的是实现数据的合理组织、有效管理、高效使用，并为仿真资源提供标准化的数据资源交互接口。

#### 分布式仿实时真数据交互管理

根据数据在仿真平台运行过程中的相对稳定性，可以分为静态数据交互管理和动态数据交互管理两类。

**（1）静态数据交互**

静态数据是指在仿真场景运行过程中相对不变的数据，数据具有一定的稳定性。这些数据，从试验开始到试验结束，基本保持不变。比如JG联合试验仿真过程中，平台JXB的状态为始终盘起的，其状态数据是维持不变无需时时更新的。因此，这些数据的交互管理，根据其使用的频率，或使其常驻计算机内存，或者以文件方式调用，或者在使用时才从数据库读取。通常对使用频率高的数据，预先将其读入计算机内存，并提供标准的通用访问接口，通过这种方式可有效提高计算机CPU处理时对数据的响应速度。仿真平台采用这种预先将数据从服务器数据库读入本地计算机内存的管理方式为模型提供数据资源，避免了在使用时通过网络远程频繁查询、调用服务器数据库，以内存空间换取了响应时间，从而提高了系统的运行效率。

**（2）动态数据交互**

动态数据是指在仿真平台运行过程中经常要发生变化的数据，如控制命令、实体行动信息、战损战果、情况报告等。这类数据通常用于参与系统应用程序间的数据交互，需要实时获取、快速处理和适时输出。动态交互数据是仿真平台运行时处理的主体，对其管理和调度直接决定引擎的反应速度和灵敏度。在一个分布式仿真系统，通常集成了仿真控制系统软件、数字模拟器、半实物模拟器、环境态势显示、综合评估等多个子系统，需要将不同仿真平台和资源进行集成，针对特定的仿真任务，完成异构仿真资源节点间的互联互通、互操作，对动态数据进行有效的分发尤为关键。

消息中间件（Message Oriented
Middleware，MOM）又称为消息系统，是一种特定的中间件，它利用高效可靠的消息传递机制进行系统无关的数据交换，并基于消息通信来进行分布式系统的集成。仿真平台必须具备异构系统信息数据识别能力和高效的信息分发能力。需要通用的数据交换格式支撑异构系统间的信息交互，同时需要实现联合仿真试验平台的高数据吞吐量和低数据通信延迟。

一个典型的基于消息中间件的发布/订阅通信模式（Publish/Subscribe，简称pub/sub或者P/S）通信范型可以抽象表示为一个六元组\<P,B,S,P_opset,B_opset,S_opset\>，

> ![378](C:/Users/Jelly/Desktop/share/任务规划/media/image51.emf){width="4.495833333333334in"
> height="2.095833333333333in"}

图
**错误!文档中没有指定样式的文字。**‑50基于发布/订阅模式的消息中间件结构

1）P=p1,p2,\...,pn表示n个信息产生者，也称为发布者（publisher）；

2）S=s1,s2,\...,sm表示m个信息消费者，也称为订阅者（subscriber）；

3）B=b1,b2,\...,bk表示一组k个代理，发布者和订阅者接入到某个代理上，代理上运行了一个分布式的通知服务（也称为事件服务）；

4）P_opset定义了发布者P具有的操作，典型的包括一个
publish(e)原语，向外发布信息；

5）S_opset定义了订阅者S具有的操作，典型的包
括subscribe(s)和unsubscribe(s)两个原语，分别表示发出和取消兴趣s，兴趣也称为
订阅（subscription）或者过滤器（filter）；

6）B_opset定义了代理B具有的操作，典型的包括notify(e)原语，向订阅者发送信息，也称为事件（event）或者通知
（notification）。

> P/S系统的典型交互，订阅者首先向通知服务通过
> subscribe原语提交自己的兴趣。发布者有事件产生时，将产生的事件发送给通知服务。通知服务对事件与订阅者的兴趣进行匹配，如果事件匹配订阅者的兴趣，
> 则将事件发送给（即"推"给）匹配的订阅者。当订阅者不再想接收事件时，通过unsubscribe原语来取消它的兴趣。
>
> 发布/订阅通信模式的特点：

1）多点通信：发布/订阅通信模式中发布者发布的信息可能满足数个订阅条件，该发布者可借助消息代理与多个订阅者通信，并且发布者可能同时也是订阅者，与别的发布者之间存在通信关系，由此发布/订阅模型中各节点可形成多点通信的关系。

2）松散耦合特性：由于发布/订阅通信模式中消息的转发都是通过消息代理完成的，因此发布者在发布消息后并不关心该消息的最终消费对象，订阅者在接收到消息后也并不关心该消息的源头，因此不论发布节点还是订阅节点发生故障都不会影响剩余节点的工作。

3）异步通信：由于发布/订阅模型松散耦合的特性，订阅者不知订阅的主题何时会接收新信息，发布者也不知所发消息是否有订阅者关心，因此系统中许多行为都以事件的形式触发，异步的执行后续操作。异构资源导调控制方法。

#### 参试资源实时状态同步与控制方法

通用平台通过构建LVC环境，将真实的、虚拟的、构造的虚实试验资源联合起来进行仿真试验，需要建设支持天地闭环反馈与仿真驱动状态同步更新的协同控制系统，实时同步试验飞行器、试验载荷的轨道参数和工作状态，以及地面测控站、数传站、中继卫星的资源使用情况，解决多系统联合仿真任务的实施。

![380](C:/Users/Jelly/Desktop/share/任务规划/media/image52.emf){width="5.904166666666667in"
height="2.504166666666667in"}图
**错误!文档中没有指定样式的文字。**‑51资源实时状态同步与控制

-   引接试验方案与计划，提取遥操作试验任务，规划并生成指令序列，由LVC导调控制模块进行分发控制，完成指令上注到LVC被试资源进行实时控制；

-   实时接收数据处理软件推送的遥测与数传数据处理结果，解析和提取被试装备的工作状态与工作参数，并将遥操作的实时试验数据和资源状进行同步；

-   获取当前被试装备、配试装备的位置与姿态，经过参试资源的状态位置计算，生成实时控制任务。

-   采用实时一致性控制模式，加载指令模板，生成实时控制指令；

-   将飞行器和遥操作的控制指令进行指令间隔控制后上注；

-   若LVC资源配合进行仿真模拟，接收任务规划软件发送的试验任务计划，调用模拟器进行初始化，根据试验任务进行模拟器仿真模型的加载调用和仿真场景生成；

#### 虚实仿真资源数据交互接口协议支持

> 仿真系统中，通常即包含仿真系统软件、时间服务软件，同时也包含数字/半实物仿真等资源，在仿真系统软件和时间服务软件中消息和指令的传递一般采用结构化的Json消息体进行传输，而一些数字/半实物仿真设备只能通过UDP方式收发帧格式的消息。这就对仿真系统中异构的仿真资源之间通信接口、数据交互内容、数据交互合适需要明确。
>
> 仿真软件系统与数字/半实物仿真资源之间需要做数据传输格式的约定，一般上行指令可以通过简化的HDLC数据格式进行数据交互。仿真软件系统具备UDF帧与简化HDLC帧格式的解析与转换能力，能够接收数据汇集分发系统的UDF帧格式数据，转换为简化的HDLC帧格式后，上注到数字/半实物模拟器

**（1）UDF数据传输格式**

  --------------------------------------------------------------------------------------------------------------------------------------
  信源地址SID   信宿地址DID   任务标标志MID   信息类码BID   标志字段FLAG   包序号NO   积日JD   积秒JS   数据字段长度LEN   数据字段DATA
  ------------- ------------- --------------- ------------- -------------- ---------- -------- -------- ----------------- --------------
  4byte         4byte         2byte           4byte         1byte          1byte      2byte    4byte    2byte             Nbyte

  --------------------------------------------------------------------------------------------------------------------------------------

  : 表5-13UDF数据传输格式

说明：

SID为信源地址，占4字节（32位），表示产生并发出本帧信息的数据站地址，当中心转发该帧信息时，SID仍为产生该帧信息的数据站地址。

DID为信宿地址，占4字节（32位），表示接收本帧信息的数据站地址，当中心转发该帧信息时，需将DID改为新的接收站地址。

MID为任务标志，占2字节（16位）。

BID为信息类别码，占2字节（16位），表示本帧信息的种类。

FLAG为标志字段，占1字节（8位），用于标识该数据明密状态加加解密处理需求。

JD为发送数据时刻的积日，占2字节（16位），从1950年1月1日开始计算。

JS为发送数据时刻的积秒，占4字节（32位），单位为0.1ms。

LEN为数据字段长度（字节数）：占2字节（16位），表示范围0～65535。若数据字段字节数\>65535，LEN取字节数的低字节的值，即将字节数对65535取模就是LEN的值。

Data为数据字段：UDF实际要传递的有真实意义的数据，由西安中心内部规程进行明确。

**（2）简化HDLC数据传输格式**

  -------------------------------------------------------------------------
  任务标志MID      信息类码BID        数据字段长度       数据字段
  ---------------- ------------------ ------------------ ------------------
  2byte            4byte              2byte              N byte

  -------------------------------------------------------------------------

  : 表5-3简化HDLC数据传输格式

说明：任务标志MID、信息类码BID和数据字段长度LEN的定义与UDF格式相同，数据字段Data在下面章节进行定义。

**（3）上行遥控数据格式**

  ------------------------------------------------------------------------
     **参数名称**      **占字节数**           **数制**          **备注**
  ------------------ ----------------- ----------------------- -----------
       数据时间              4               无符号整数           25us

       数据长度              4               二进制原码        

      指令帧内容             N               二进制原码        
  ------------------------------------------------------------------------

  : 表5-4上行遥控数据格式数据字段定义

说明：

数据时间：当前的系统时间(不包括年月日信息)，高字节在后、低字节在前，如10时20分30秒600毫秒传输顺序为40C1C358H。数据时间不用作时间符合功能，但数据时间要在接收到指令时给与显示，同时将接收时的时间显示出来，主要便于查找指令接收环节的延时。

数据长度：数据长度为指令内容的有效位数，高字节在后、低字节在前。

指令帧内容：指令内容为从启动序列开始的全帧遥控指令码，如下图所示。

![](C:/Users/Jelly/Desktop/share/任务规划/media/image53.emf)图5-10
上行数据指令帧结构

#### 仿真体系导调控制架构与导调方法

> 在异构资源协同控制仿真平台中，导调控制起着十分重要的作用，它是仿真模拟任务中指挥人员以导演的身份，在宏观和全局上对仿真任务进行引导和控制，在微观和局部上对仿真任务实施调节的一系列活动。它不仅是使仿真任务的各个环节处于严密的控制之下，并按照一定的仿真作战进程有序、高效的进行和保障，同时也是组织实施多场景、多任务一体化仿真任务的重要组成部分和支撑环境。
>
> 从概念上讲，仿真平台的导调控制主要由四项基本功能，即仿真环境构设与初始化、传输导调信息和指令、控制仿真任务进程、辅助裁决和评估。但一般环境构设与初始化能力和辅助裁决评估一般有导调成员配合其他系统或成员（如态势、数据采集、效能评估等）来完成。所以仿真平台中的导调控制主要功能就集中在传输导调指令和控制仿真进程功能上。

**（1）导调控制架构**

> 仿真导调控制架构分四层进行设计：
>
> ![384](C:/Users/Jelly/Desktop/share/任务规划/media/image54.emf){width="5.6in"
> height="2.2958333333333334in"}
>
> 图 **错误!文档中没有指定样式的文字。**‑52导调控制模块架构

1）界面层：提供信息显示与导调控制界面，包括仿真任务信息的综合信息显示、态势信息显示、仿真任务进程控制界面、资源实体界面、环境信息调整界面等。

2）功能层：主要包括导调控制功能和状态监视功能，分别由导调控制器和状态监视器完成。导调控制器主要完成想定方案加载、仿真运行控制、控制指令转发、仿真资源新增与删减、仿真资源状态属性变更等；状态监视为导调控制提供信息支持，监视内容包括任务状态、载荷状态、环境信息、资源信息、仿真任务综合信息等。

3）网络接口层：包括UDP/IP网络通道，支持数字/半实物模拟器与仿真控制平台之间指令消息的协议帧转换；同时提供基于发布订阅模式的消息中间件，为操控指令和状态控制指令转发提供底层支撑。

4）数据层：提供仿真平台运行的各种数据，包括场景想定数据，操控指令数据、仿真资源数据等。

**（2）按指令用途区分导调控制单元**

1）资源操控导调单元，主要处理由指令加工与数据注入子系统产生，经过验证的遥控指令，根据上注对象、任务模式以及链路状态，按规则和时间顺序完成自动发控，完成指令的上注。

2）场景控制导调单元，负责仿真进程的控制，包括仿真开始 、暂停 、继续
、变速、结束等，由指挥人员操作，通过导调控制模块下达，并发送给所有仿真实体系统，仿真实体收到指令后控制自身的仿真状态，实现仿真进程的总体控制。

3）临机控制导调单元，是在仿真任务运行过程中，接收由任务指挥人员根据仿真进程中各仿真资源的状态，人工临机干预所需要发控的指令，并上注到仿真资源中，从而改变资源的状态、参试资源参数或数量、仿真任务环境等。不同的仿真资源可以接收多种特定导调指令，针对此类命令要规范化处理，利于后续扩展新的指令。

**（3）导调控制特征分析与解决方法**

> 导调控制系统的核心功能是对试验任务进程实时科学、合理、便捷的导调控制，使参演的仿真资源在任务指挥人员的统一指挥调度之下，完成试验任务。太空XX试验任务的固有特征决定着太空试验任务导调控制呈现以下特征：

1）空间广阔，协调难度大。太空试验任务涵盖各类航天器、信息链路和地面控制保障系统，空间分布广泛，特别是天基系统轨道运行具有全球性特征。太空任务演训需要在广阔空间范围进行，协调组织和导调控制难度大。

临机干预导调，任务有序推进。在太空试验任务执行过程中，实时获取试验环境、试验资源（包括参试装备、配试装备、地面测控运控站、中继卫星系统等）、电磁环境、安全态势等态势信息，以此为基础，选择恰当的时机进行实时临机导调。围绕试验任务意图，兼顾任务进程，动态判断，及时决策，对试验环境、资源属性\\参数\\数量等进行导调。

2）体系联动，导调控制难。太空仿真试验任务中，受控对象种类多样，飞行器、模拟器、实装等仿真资源集成，需要按照符合内在逻辑的任务流程实施演练，资源间实现紧密耦合联动，任何一个资源出现问题都会导致试验任务失败。仿真任务过程中容易出现各类仿真能力不协调，时空分辨率及仿真精度上存在差异，常常导致仿真进度上的差异消息指令处理方式不同等问题，在进行跳时、倍速等导调控制时，无法实现资源状态同步问题。

制定导调基准，协同资源状态。针对各仿真资源能力不协调问题，需要结合仿真资源特征，分析其关系、特性和重要程度，制定导调基准，例如：某半实物仿真资源能够接受倍速或跳时的能力较低，可以考虑在倍速和跳时导调控制时，以该仿真资源为基准进行导调。

3）资源异构，技术难度高。通用平台需要对现有的仿真资源进行整合，统一设计和管理，需要保障导调控制系统与各仿真资源间通信顺畅无阻，实现资源间消息和指令的互联互通，满足数字/半实物仿真资源、真星系统组件、地面操控系统间的协调运行。然而不同时期、不同厂商所提供的仿真资源标准有所不同，所需导调的仿真资源信息交互呈现物理层接口多样、通信协议多样、通信性能多样的问题。

协议转换插件，协助信息交互。在通用平台中支持以"插件"的方式集成协议转换中间件，在虚拟仿真设备、实装设备之间进行指令和数据交互时，根据部署的协议适配"插件"对交互内容进行协议转换。平台可以根据接入的仿真资源选择动态的加载不同协议转换"插件"，完成不同协议的相互转换。

4）天地一体，协同要求高。太空任务体系不但包括在轨航天器，也包括发射场、测控站、地面站等地面装备，任务目标需要以天地一体化任务体系为基础，通过各要素紧密配合才能实现。在太空试验任务中，设计的系统复杂，导调过程需要高效协同、紧密配合。

开展策略推演任务场景构设想定，依据贴近实战要求，完成态势场景分配想定与环境构设。同时以试验任务目标为依据，在试验任务过程中控制参试仿真资源，准确判断态势，合理调度资源，控制试验任务节奏。

## [未来展望]{.mark} {#未来展望 .2级列表}
